---
# title: "Tutorial"
# author: "Maryam Seifeldin"
# date: "11/4/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(ltm)
library(car)
library(fastDummies)

valdata <- read.csv("altruism_data_values.csv", header=TRUE)
numdata <- read.csv("altruism_data_numeric.csv", header=TRUE)
fulldata <- numdata
ourdata <- subset(fulldata, Consent==1)
data <- dplyr::select(ourdata,.data$praise_rejection_1 : .data$botcatcher)
colnames(data)[19] <- "Age"
data[,] <- sapply(data[,], as.character)
data$condition <- ifelse(data$likely_nonpro != "", "nonpro", "pro")
data$vignette_response <- ifelse(data$likely_nonpro == "", data$likely_pro, data$likely_nonpro)
data$justification <- ifelse(data$bot_catcher == "", data$botcatcher, data$bot_catcher)
data <- subset(data, select = -c(likely_nonpro, likely_pro, botcatcher, bot_catcher))
data$vignette_response <- as.numeric(data$vignette_response)
data$Age <- as.numeric(data$Age)
data[,1:18] <- sapply(data[,1:18],as.numeric)
data <- data %>%
  mutate(justification,
         praise_rejection = rowMeans(dplyr::select(., -c(Age, condition, vignette_response, justification)),na.rm = TRUE))
data$age_bracket <- ifelse(data$Age < 30 , "20s" , 
                           ifelse(data$Age < 40 , "30s", 
                                  ifelse(data$Age < 50 , "40s", "50s")))
dummies <- dummy_cols(data$age_bracket)

data$dummies_20s <- dummies$.data_20s
data$dummies_30s <- dummies$.data_30s
data$dummies_40s <- dummies$.data_40s
data$dummies_50s <- dummies$.data_50s
```
```{r, eval = TRUE} 
data %>%
  group_by(condition) %>%
    summarise(mean(vignette_response))
```
Code translation: We tell R to look at teh data in the "data" dataframe, then say we're going to group a column calculation by the levels of the "condition" column with the group_by() command. Then we give R the column calculation we want: a printout of the mean of the vignette_response column.
```{r, eval = TRUE} 
data %>%
  group_by(condition, age_bracket) %>%
  summarise(mean(vignette_response))
```
Code translation: In the second step of the grouping, where we tell R which variables we want to group our calculation by, we can split things up into further groups with a comma between the multiple column names. Here, we tell R we want to split the data up by condition, then split that split-up data age. So we end up with 8 groups (2 condition groups x 4 age bracket groups).
```{r, eval = TRUE} 
data %>%
  group_by(condition) %>%
  summarise(min(vignette_response), max(vignette_response))
```
And you can generate a grouped table with more than one calculation, if you need to do more than one statistic that is grouped by another variable.